[General]
DeactivateToken = UPDATE tokens SET expiration_date = current_date WHERE value = %%s
UserId = SELECT id FROM users WHERE login = %%s

[Auth]
Register = INSERT INTO users (login, password, email, username, registration_date) VALUES (%%s, %%s, %%s, %%s, current_date) RETURNING id
AssignActivationToken = INSERT INTO tokens (user_id, token_category_id, expiration_date, value) VALUES (%%s, 1, current_date + interval '1 week', %%s)
ValidateUser = SELECT EXISTS (SELECT * FROM users WHERE login = %%s AND password ILIKE %%s)
ActivateAccount = UPDATE users SET is_activated = TRUE WHERE id IN (SELECT id FROM tokens WHERE value ilike %%s AND token_category_id = 1 and current_date < expiration_date) RETURNING login

[User]
Info = SELECT email, username, registration_date FROM users WHERE login = %%s
Update = UPDATE users set password = %%s, email = %%s, username = %%s WHERE login = %%s
Delete = DELETE FROM users WHERE login = %%s

[Subaccount]
List = SELECT id, name FROM subaccounts WHERE user_id = %%s
New = INSERT INTO subaccounts (user_id, name) VALUES (%%s, %%s)
Update = UPDATE subaccounts SET name = %%s WHERE id = %%s AND user_id = %%s
Delete = DELETE FROM subaccounts WHERE id = %%s AND user_id = %%s